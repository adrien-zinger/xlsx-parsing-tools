{"version":3,"sources":["../../src/parse-xlsx/horizontalStyle.js"],"names":["getJsonFromTable","table","keyAdapter","headAdapter","id","undefined","key","head","out","keyLine","keyCount","i","length","arr","j"],"mappings":";;;;;qBAgBwBA,gB;;AAhBxB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEe,SAASA,gBAAT,CACbC,KADa,EAGb;AAAA,iFADkC,EAClC;AAAA,MADEC,UACF,QADEA,UACF;AAAA,MADcC,WACd,QADcA,WACd;AAAA,MAD2BC,EAC3B,QAD2BA,EAC3B;;AACA,MAAIF,UAAU,KAAKG,SAAnB,EAA8BH,UAAU,GAAG,oBAACI,GAAD;AAAA,WAASA,GAAT;AAAA,GAAb;AAC9B,MAAIH,WAAW,KAAKE,SAApB,EAA+BF,WAAW,GAAG,qBAACI,IAAD;AAAA,WAAUA,IAAV;AAAA,GAAd;AAC/B,MAAMC,GAAG,GAAG,EAAZ;AACA,MAAMC,OAAO,GAAG,EAAhB;AACA,MAAMC,QAAQ,GAAG,EAAjB;;AACA,OAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGV,KAAK,CAAC,CAAD,CAAL,CAASW,MAA7B,EAAqC,EAAED,CAAvC;AACE,QAAIV,KAAK,CAAC,CAAD,CAAL,CAASU,CAAT,MAAgB,EAApB,EAAwB;AACtB,UAAML,GAAG,GAAGJ,UAAU,CAACD,KAAK,CAAC,CAAD,CAAL,CAASU,CAAT,CAAD,EAAcP,EAAd,CAAtB;AACA,UAAIE,GAAG,KAAKD,SAAZ,EAAuB;;AACvB,UAAIK,QAAQ,CAACJ,GAAD,CAAR,KAAkBD,SAAtB,EAAiC;AAC/BK,QAAAA,QAAQ,CAACJ,GAAD,CAAR,GAAgB,CAAhB;AACAG,QAAAA,OAAO,CAACE,CAAD,CAAP,GAAaL,GAAb;AACD,OAHD,MAGO;AACLG,QAAAA,OAAO,CAACE,CAAD,CAAP,GAAaL,GAAG,GAAI,EAAEI,QAAQ,CAACJ,GAAD,CAA9B;AACD;AACF;AAVH;;AAWA,OAAK,IAAIK,EAAC,GAAG,CAAb,EAAgBA,EAAC,GAAGV,KAAK,CAACW,MAA1B,EAAkC,EAAED,EAApC,EAAuC;AACrC,QAAME,GAAG,GAAGZ,KAAK,CAACU,EAAD,CAAjB;AACA,QAAMJ,IAAI,GAAGJ,WAAW,CAACU,GAAG,CAAC,CAAD,CAAJ,EAAST,EAAT,CAAxB;AACA,QAAIG,IAAI,KAAKF,SAAb,EAAwB;AACxBG,IAAAA,GAAG,CAACD,IAAD,CAAH,GAAY,EAAZ;;AACA,SAAK,IAAIO,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,GAAG,CAACD,MAAxB,EAAgC,EAAEE,CAAlC;AACE,UAAIL,OAAO,CAACK,CAAD,CAAP,KAAeT,SAAnB,EAA8BG,GAAG,CAACD,IAAD,CAAH,CAAUE,OAAO,CAACK,CAAD,CAAjB,IAAwBD,GAAG,CAACC,CAAD,CAA3B;AADhC;AAED;;AACD,SAAON,GAAP;AACD","sourcesContent":["// Parse table horizontal style. Get json\n\n/*\n\n       |   A  |  B\n  Name | val1 | val2\n\n=>\n{\n  \"Name\": {\n    \"A\": \"val1\",\n    \"B\": \"val2\"\n  }\n}\n*/\n\nexport default function getJsonFromTable(\n  table,\n  { keyAdapter, headAdapter, id } = {}\n) {\n  if (keyAdapter === undefined) keyAdapter = (key) => key\n  if (headAdapter === undefined) headAdapter = (head) => head\n  const out = {}\n  const keyLine = {}\n  const keyCount = {}\n  for (let i = 0; i < table[0].length; ++i)\n    if (table[0][i] !== \"\") {\n      const key = keyAdapter(table[0][i], id)\n      if (key === undefined) continue\n      if (keyCount[key] === undefined) {\n        keyCount[key] = 1\n        keyLine[i] = key\n      } else {\n        keyLine[i] = key + (++keyCount[key])\n      }\n    }\n  for (let i = 1; i < table.length; ++i) {\n    const arr = table[i]\n    const head = headAdapter(arr[0], id)\n    if (head === undefined) continue\n    out[head] = {}\n    for (let j = 1; j < arr.length; ++j)\n      if (keyLine[j] !== undefined) out[head][keyLine[j]] = arr[j]\n  }\n  return out\n}\n"],"file":"horizontalStyle.js"}