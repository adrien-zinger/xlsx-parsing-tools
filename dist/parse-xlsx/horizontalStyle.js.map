{"version":3,"sources":["../../src/parse-xlsx/horizontalStyle.js"],"names":["getJsonFromTable","table","keyAdapter","headAdapter","id","undefined","key","head","out","keyLine","i","length","arr","j"],"mappings":";;;;;;;AAAA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEe,SAASA,gBAAT,CACbC,KADa,EAGb;AAAA,iFADkC,EAClC;AAAA,MADEC,UACF,QADEA,UACF;AAAA,MADcC,WACd,QADcA,WACd;AAAA,MAD2BC,EAC3B,QAD2BA,EAC3B;;AACA,MAAIF,UAAU,KAAKG,SAAnB,EAA8BH,UAAU,GAAG,oBAACI,GAAD;AAAA,WAASA,GAAT;AAAA,GAAb;AAC9B,MAAIH,WAAW,KAAKE,SAApB,EAA+BF,WAAW,GAAG,qBAACI,IAAD;AAAA,WAAUA,IAAV;AAAA,GAAd;AAC/B,MAAMC,GAAG,GAAG,EAAZ;AACA,MAAMC,OAAO,GAAG,EAAhB;;AACA,OAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGT,KAAK,CAAC,CAAD,CAAL,CAASU,MAA7B,EAAqC,EAAED,CAAvC;AACE,QAAIT,KAAK,CAAC,CAAD,CAAL,CAASS,CAAT,MAAgB,EAApB,EAAwB;AACtB,UAAMJ,GAAG,GAAGJ,UAAU,CAACD,KAAK,CAAC,CAAD,CAAL,CAASS,CAAT,CAAD,EAAcN,EAAd,CAAtB;AACA,UAAIE,GAAG,KAAKD,SAAZ,EAAuB;AACvBI,MAAAA,OAAO,CAACC,CAAD,CAAP,GAAaJ,GAAb;AACD;AALH;;AAMA,OAAK,IAAII,EAAC,GAAG,CAAb,EAAgBA,EAAC,GAAGT,KAAK,CAACU,MAA1B,EAAkC,EAAED,EAApC,EAAuC;AACrC,QAAME,GAAG,GAAGX,KAAK,CAACS,EAAD,CAAjB;AACA,QAAMH,IAAI,GAAGJ,WAAW,CAACS,GAAG,CAAC,CAAD,CAAJ,EAASR,EAAT,CAAxB;AACA,QAAIG,IAAI,KAAKF,SAAb,EAAwB;AACxBG,IAAAA,GAAG,CAACD,IAAD,CAAH,GAAY,EAAZ;;AACA,SAAK,IAAIM,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,GAAG,CAACD,MAAxB,EAAgC,EAAEE,CAAlC;AACE,UAAIJ,OAAO,CAACI,CAAD,CAAP,KAAeR,SAAnB,EAA8BG,GAAG,CAACD,IAAD,CAAH,CAAUE,OAAO,CAACI,CAAD,CAAjB,IAAwBD,GAAG,CAACC,CAAD,CAA3B;AADhC;AAED;;AACD,SAAOL,GAAP;AACD","sourcesContent":["// Parse table horizontal style. Get json\n\n/*\n\n       |   A  |  B\n  Name | val1 | val2\n\n=>\n{\n  \"Name\": {\n    \"A\": \"val1\",\n    \"B\": \"val2\"\n  }\n}\n*/\n\nexport default function getJsonFromTable(\n  table,\n  { keyAdapter, headAdapter, id } = {}\n) {\n  if (keyAdapter === undefined) keyAdapter = (key) => key\n  if (headAdapter === undefined) headAdapter = (head) => head\n  const out = {}\n  const keyLine = {}\n  for (let i = 0; i < table[0].length; ++i)\n    if (table[0][i] !== \"\") {\n      const key = keyAdapter(table[0][i], id)\n      if (key === undefined) continue\n      keyLine[i] = key\n    }\n  for (let i = 1; i < table.length; ++i) {\n    const arr = table[i]\n    const head = headAdapter(arr[0], id)\n    if (head === undefined) continue\n    out[head] = {}\n    for (let j = 1; j < arr.length; ++j)\n      if (keyLine[j] !== undefined) out[head][keyLine[j]] = arr[j]\n  }\n  return out\n}\n"],"file":"horizontalStyle.js"}